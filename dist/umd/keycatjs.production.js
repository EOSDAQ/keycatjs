!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).keycatjs={})}(this,function(t){"use strict";var i=function(){var e=this;this.resolve=null,this.reject=null,this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})},r=function(){return(r=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},a={eos:["telos","telos-testnet"]};function n(){}var c={eos:(n.prototype.isAcceptable=function(t){var n=t.name,e=t.nodes;return!!a.eos.find(function(t){return n===t})&&(e||function(t){var n=t.name,e=t.property,o=t.blockchain;throw new Error("Property '"+e+"' in 'blockchain' is required. This error occurred because '"+n+"' should follow initialization rules of '"+o+"' configuration.")}({name:n,property:"nodes",blockchain:"eos"}),!0)},n)};function o(t,n,e){var o=new URL(t+n),r=new URLSearchParams;return r.set("blockchain",JSON.stringify(e.blockchain)),r.set("client",location.origin),e.account&&r.set("account",e.account),e.args&&r.set("payload",e.args),o.search=r.toString(),o.href}var s,e=(s=function(t,n){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),u=(l.prototype.validateBlockchain=function(t){for(var n=t.name,e=t.plugin,o=0,r=Object.keys(c);o<r.length;o++){var i=r[o];if((new c[i]).isAcceptable(t))return}if(!n||!e)throw new Error("Unknown configuration for 'blockchain' property.");console.warn("You are using custom name. We hope you understand what you are doing. We recommend using a preset name.")},l.prototype.spawnWindow=function(t,n){var e=this;if(void 0===n&&(n=!1),n&&!this._account)throw new Error('You must chain "account" method first. e.g) keycat.account(accountName).transact(...) ');var o=new i;this.win=function(t,n){if("page"===n)return window.open(t,"_blank");var e=["width=480","height=720","top="+(window.top.outerHeight/2+window.top.screenY-360),"left="+(window.top.outerWidth/2+window.top.screenX-240)].join(",");return window.open(t,"Keycat",e)}(t,this.config.ux);var r=setInterval(function(){e.win&&!e.win.closed||(clearInterval(r),o.reject("closed"))},500);return window.onmessage=function(t){var n=t.data;n.____keycat&&e.sendResponse(n,o)},o.promise},l.prototype.sendResponse=function(t,n){var e=t.type,o=t.payload;if("close"===e)n.reject("closed");else{var r=o.data,i=o.error;i&&n.reject(i),r&&n.resolve(r)}this.win&&this.win.close(),this.win=null},l.prototype.makeUrlData=function(t){return{blockchain:function(n){for(var t=0,e=Object.keys(a);t<e.length;t++){var o=e[t];if(a[o].find(function(t){return t===n.name}))return r({},n,{plugin:o})}if(!n.plugin)throw new Error("Cannot find 'plugin' property for your custom 'blockchain' configuration.");return n}(this.config.blockchain),account:this._account,args:encodeURIComponent(btoa(JSON.stringify(t)))}},Object.defineProperty(l.prototype,"keycatOrigin",{get:function(){var t=this.config,n=(t.__keycatOrigin,t.blockchain);return n.name,n.urlOrigin},enumerable:!0,configurable:!0}),l.prototype.account=function(t){return this._account=t,this},l.prototype.signin=function(){var t=o(this.keycatOrigin,"/signin",this.makeUrlData());return this.spawnWindow(t)},l.prototype.transact=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=o(this.keycatOrigin,"/transact",this.makeUrlData(t));return this.spawnWindow(e,!0)},l.prototype.signArbitraryData=function(t){var n=o(this.keycatOrigin,"/sign-arbitrary-data",this.makeUrlData([t]));return this.spawnWindow(n,!0)},l.prototype.signTransaction=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=o(this.keycatOrigin,"/sign-transaction",this.makeUrlData(t));return this.spawnWindow(e,!0)},l);function l(t){this.config=t,this.sign=this.signTransaction,this.validateBlockchain(t.blockchain),this._account=t.account}var p,h=(e(f,p=u),f);function f(t){return p.call(this,{blockchain:{name:"telos",urlOrigin:"https://wallet.telos.net",nodes:t}})||this}var d,y=(e(w,d=u),w);function w(t){return d.call(this,{blockchain:{name:"telos-testnet",urlOrigin:"http://localhost:3030",nodes:t}})||this}u.Telos=h,u.TelosTestnet=y,t.Keycat=u,Object.defineProperty(t,"__esModule",{value:!0})});