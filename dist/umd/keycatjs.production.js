!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).keycatjs={})}(this,function(t){"use strict";var i=function(){var o=this;this.resolve=null,this.reject=null,this.promise=new Promise(function(t,n){o.resolve=t,o.reject=n})},r=function(){return(r=Object.assign||function(t){for(var n,o=1,e=arguments.length;o<e;o++)for(var r in n=arguments[o])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},a={eos:["telos","telos-testnet"]};function n(){}var c={eos:(n.prototype.isAcceptable=function(t){var n=t.name,o=t.nodes,e=t.urlOrigin;return console.log("about to validate isAcceptable",n,o,e),!!a.eos.find(function(t){return n===t})&&(o||function(t){var n=t.name,o=t.property,e=t.blockchain;throw new Error("Property '"+o+"' in 'blockchain' is required. This error occurred because '"+n+"' should follow initialization rules of '"+e+"' configuration.")}({name:n,property:"nodes",blockchain:"eos"}),console.log("EosValidator true"),!0)},n)};function e(t,n,o){var e=new URL(t+n),r=new URLSearchParams;return r.set("blockchain",JSON.stringify(o.blockchain)),r.set("client",location.origin),o.account&&r.set("account",o.account),o.args&&r.set("payload",o.args),e.search=r.toString(),e.href}var s,o=(s=function(t,n){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(t,n)},function(t,n){function o(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}),u=(l.prototype.validateBlockchain=function(t){for(var n=t.name,o=t.plugin,e=0,r=Object.keys(c);e<r.length;e++){var i=r[e];if((new c[i]).isAcceptable(t))return}if(!n||!o)throw new Error("Unknown configuration for 'blockchain' property.");console.warn("You are using custom name. We hope you understand what you are doing. We recommend using a preset name.")},l.prototype.spawnWindow=function(t,n){var o=this;if(void 0===n&&(n=!1),n&&!this._account)throw new Error('You must chain "account" method first. e.g) keycat.account(accountName).transact(...) ');var e=new i;this.win=function(t,n){if("page"===n)return window.open(t,"_blank");var o=["width=480","height=720","top="+(window.top.outerHeight/2+window.top.screenY-360),"left="+(window.top.outerWidth/2+window.top.screenX-240)].join(",");return window.open(t,"Keycat",o)}(t,this.config.ux);var r=setInterval(function(){o.win&&!o.win.closed||(clearInterval(r),e.reject("closed"))},500);return window.onmessage=function(t){var n=t.data;n.____keycat&&o.sendResponse(n,e)},e.promise},l.prototype.sendResponse=function(t,n){var o=t.type,e=t.payload;if("close"===o)n.reject("closed");else{var r=e.data,i=e.error;i&&n.reject(i),r&&n.resolve(r)}this.win&&this.win.close(),this.win=null},l.prototype.makeUrlData=function(t){return{blockchain:function(n){for(var t=0,o=Object.keys(a);t<o.length;t++){var e=o[t];if(a[e].find(function(t){return t===n.name}))return r({},n,{plugin:e})}if(!n.plugin)throw new Error("Cannot find 'plugin' property for your custom 'blockchain' configuration.");return n}(this.config.blockchain),account:this._account,args:encodeURIComponent(btoa(JSON.stringify(t)))}},Object.defineProperty(l.prototype,"keycatOrigin",{get:function(){console.log("this.config is: ",this.config);var t=this.config,n=(t.__keycatOrigin,t.blockchain);return n.name,n.urlOrigin},enumerable:!0,configurable:!0}),l.prototype.account=function(t){return this._account=t,this},l.prototype.signin=function(){var t=e(this.keycatOrigin,"/signin",this.makeUrlData());return this.spawnWindow(t)},l.prototype.transact=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=e(this.keycatOrigin,"/transact",this.makeUrlData(t));return this.spawnWindow(o,!0)},l.prototype.signArbitraryData=function(t){var n=e(this.keycatOrigin,"/sign-arbitrary-data",this.makeUrlData([t]));return this.spawnWindow(n,!0)},l.prototype.signTransaction=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=e(this.keycatOrigin,"/sign-transaction",this.makeUrlData(t));return this.spawnWindow(o,!0)},l);function l(t){this.config=t,this.sign=this.signTransaction,console.log("in Keycat constructor and config: ",t),this.validateBlockchain(t.blockchain),this._account=t.account}var p,h=(o(f,p=u),f);function f(t){return console.log("in KeycatTelos constructor"),p.call(this,{blockchain:{name:"telos",urlOrigin:"https://wallet.telos.net",nodes:t}})||this}var g,d=(o(y,g=u),y);function y(t){return console.log("in KeycatTelosTestnet constructor"),g.call(this,{blockchain:{name:"telos-testnet",urlOrigin:"http://localhost:3030",nodes:t}})||this}u.Telos=h,u.TelosTestnet=d,t.Keycat=u,Object.defineProperty(t,"__esModule",{value:!0})});